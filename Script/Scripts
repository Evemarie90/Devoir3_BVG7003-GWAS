library(readxl)

# Read the Excel file into R
excel_data <- read_excel("exported_dataset.xlsx")

# Write the data to a Hapmap file
write.table(excel_data, file = "output_file.hmp.txt", 
            sep = "\t", row.names = FALSE, quote = FALSE)


MVP.Data(fileHMP="output_file.hmp.txt",
         filePhe="Phenotype_African.txt",
         sep.hmp="\t",
         sep.phe="\t",
         SNP.effect="Add",
         fileKin=FALSE,
         filePC=FALSE,
         #maxLine=10000,
         out="mvp.hmp"
         )


genotype <- attach.big.matrix("mvp.hmp.geno.desc")
phenotype <- read.table("mvp.hmp.phe",head=TRUE)
map <- read.table("mvp.hmp.geno.map" , head = TRUE)


for(i in 2:ncol(phenotype)){
  imMVP <- MVP(
    phe=phenotype[, c(1, i)],
    geno=genotype,
    map=map,
    #K=Kinship,
    #CV.GLM=Covariates,
    #CV.MLM=Covariates,
    #CV.FarmCPU=Covariates,
    nPC.GLM=5,
    nPC.MLM=3,
    nPC.FarmCPU=3,
    maxLine=10000,
    #ncpus=10,
    vc.method="BRENT",
    method.bin="static",
    threshold=0.05,
    method=c("GLM", "MLM", "FarmCPU"),
    file.output=c("pmap", "pmap.signal", "plot", "log")
  )
  gc()
}
